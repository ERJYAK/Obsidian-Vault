Система диспечеризации. Основа всей MES-системы.
Обеспечивает сбор данных из внешних источников, сохранение этих данных в БД и предоставление этих данных наружу.

Сервисы, которые пользуются этой информацией могут быть как внешние приемники (SCADA системы), так и внутренние потребители (модули расчета, модули сведения балансов, порталы и т.д.).

**TSDB Server (Time Service Data Base)** - хранит данные. База данных хранения временных рядов. Клиентское приложение может обращаться к TSDB Server для получения данных. Так же клиентское приложение может обратно класть данные (но, например, по другим тэгам).  ^efacac

**TSDB Connector** - Общее название библиотек для взаимодейтсвия с TSDB Server. Подключаются внешними клиентскими сервисами (сайтами или приложениями). 
^efa110

**TSDB Worker Service** - сервис, который выполняет фоновую работу по обслуживанию БД. Обеспечивает наполнение актуальных и нужных данных, удаление неактуальных данных в Redis. Обеспечение работы подписок и т.п.

**OPC DA Server** - Позволяет представить [TSDB Server](#^efacac) как *DA Server* и реализует *OPC* клиент.  Часто на предприятиях используется протокол взаимодействия *OPC DA*. Его проблема в том, что он очень старый и поддерживается только семейством Microsoft.  
^efa101

**TSDB Web API** - Набор серверных компонентов для обеспечения взаимодействия TSDB с внешним миром по REST API. 
^efa111

**Тэг** -  в данном случае это параметр, который отвечает за определенный временной ряд. Временной ряд в данном случае, это какое-либо изменяющийся во времени параметр. У тэгов имеются метаданные. Это набор атрибутов, которые влияют на сбор хранение и предоставление данных. 
^efa112

**Снэпшот** - это значение тэга, которое пришло последним по времени. Это самые востребованные данные. Такие данные хранятся в кэшированной БД. ^efa113

**Подписка** - у пользователя есть возможность подписаться на тэг. В таком случае данные тэга будут сохранятся в кэше. 
^efa114

# Хранение данных

В TSDB есть 3 вида хранилища данных. Они используются для разных задач и поребляют разные ресурсы.

## MS SQL и PosgreSQL

Используюится для хранения реляционных данных. то есть, таких данных, у которых сложная организация. Но при этом такие данные не очень часто пишутся и забираются, поэтому такие базы не предназначены для больших нагрузок.

Примерами таких данных могут быть пользователи, структура прав доступа пользоваетелей, а также метаданные [тэгов](#^efa112).

## Cassandra и ClickHouse

Используются для хранения большого количесвта постоянно обновляющихся данных. Используются из-за возможности выдерживать большие нагрузки (кол-во запросов на запись или чтение), а также из-за быстродействия работы с большим объемом данных (по сравнению с реляционными БД).

В данном случае хранят сами данные [тэгов](#^efa112).

## Redis

БД которая хранит данные в кэше (оперативной памяти). Очень быстро пишет и читает данные. Используется для хранения оперативной и часто запрашиваемой информации (например для хранения [снэпшотов](#^efa113) и [подписок](#^efa114)).

Главные недостатки этой БД в том, что она не может хранить такой же объем информации, как и дисковые БД, так как кол-во оперативной памяти сильно меньше. Также ее проблема в том, что она не сохраняет данные после выключения машины.

# Интерфейс

**Интерфейсы** - в данном случае, это агенты сбора данных (ничего общего с интефрейсами в C# или UI). Сервис (их может быть много), который берет данные из источника данных и кладет их в [TSDB Server](#^efacac). ^fc877b

Могут быть частые случаи, когда источником данных одного интерфейса может быть другой интерфейс.

**Общие правила работы интерфейсов:**
1.  Должно быть настроено подключение к *TSDB Server* и к *Источнику данных*. К *TSDB Server* у всех интерфейсов подключение настраивается одинакого. А подключение к истонику данных зависит от интерфейса.
	1. Если интерфейс [OPC DA](#^efa101), то в этом случае мы прописываем логику подклбчения к *DA Server - источнику*. 
	2. Есть интерфейс RDB. Он позволяет собирать данные из реаляционных БД. В этом случае релизуем логику подклбчения к *источнику - реляционной БД*.

2. Настройка правил принадлежности [тэгов](#^efa112). То есть, какие конкретно тэги использует для работы этот конкретный интерфейс.